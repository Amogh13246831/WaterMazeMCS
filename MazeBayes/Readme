Efficient implementation that performs similarly to the other
